<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.2 Modelos de semivariogramas | Estadística Espacial con R</title>
  <meta name="description" content="Apuntes de Estadística Espacial (para las asignaturas: ‘Análisis estadístico de datos con dependencia’ del Grado en Ciencia e Ingeniería de Datos y ‘Aprendizaje estadístico’ del Máster InterUniversitario en Técnicas Estadísticas)." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="3.2 Modelos de semivariogramas | Estadística Espacial con R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Apuntes de Estadística Espacial (para las asignaturas: ‘Análisis estadístico de datos con dependencia’ del Grado en Ciencia e Ingeniería de Datos y ‘Aprendizaje estadístico’ del Máster InterUniversitario en Técnicas Estadísticas)." />
  <meta name="github-repo" content="rubenfcasal/estadistica_espacial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.2 Modelos de semivariogramas | Estadística Espacial con R" />
  
  <meta name="twitter:description" content="Apuntes de Estadística Espacial (para las asignaturas: ‘Análisis estadístico de datos con dependencia’ del Grado en Ciencia e Ingeniería de Datos y ‘Aprendizaje estadístico’ del Máster InterUniversitario en Técnicas Estadísticas)." />
  

<meta name="author" content="Rubén Fernández Casal (MODES, CITIC, UDC; ruben.fcasal@udc.es)" />
<meta name="author" content="Tomás Cotos Yáñez (SIDOR, UVIGO; cotos@uvigo.es)" />


<meta name="date" content="2021-11-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="vario-muestrales.html"/>
<link rel="next" href="ajuste-variog.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.19/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Aprendizaje Estadístico</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="intro-estesp.html"><a href="intro-estesp.html"><i class="fa fa-check"></i><b>1</b> Introducción: Procesos espaciales y Geoestadística</a>
<ul>
<li class="chapter" data-level="1.1" data-path="proc-esp.html"><a href="proc-esp.html"><i class="fa fa-check"></i><b>1.1</b> Procesos espaciales</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="proc-esp.html"><a href="proc-esp.html#paquetes-r"><i class="fa fa-check"></i><b>1.1.1</b> Paquetes de R</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="geoestadistica.html"><a href="geoestadistica.html"><i class="fa fa-check"></i><b>1.2</b> Geoestadística</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="geoestadistica.html"><a href="geoestadistica.html#modelos-clasicos-espaciales"><i class="fa fa-check"></i><b>1.2.1</b> Modelos clásicos y modelos espaciales</a></li>
<li class="chapter" data-level="1.2.2" data-path="geoestadistica.html"><a href="geoestadistica.html#ventajas-de-la-aproximación-espacial-y-espacio-temporal"><i class="fa fa-check"></i><b>1.2.2</b> Ventajas de la aproximación espacial (y espacio-temporal)</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="procesos-estacionarios.html"><a href="procesos-estacionarios.html"><i class="fa fa-check"></i><b>1.3</b> Procesos espaciales estacionarios</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="procesos-estacionarios.html"><a href="procesos-estacionarios.html#propiedades-elementales"><i class="fa fa-check"></i><b>1.3.1</b> Propiedades elementales del covariograma y del variograma</a></li>
<li class="chapter" data-level="1.3.2" data-path="procesos-estacionarios.html"><a href="procesos-estacionarios.html#procesos-agregados"><i class="fa fa-check"></i><b>1.3.2</b> Procesos agregados</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="objetivos-esquema.html"><a href="objetivos-esquema.html"><i class="fa fa-check"></i><b>1.4</b> Objetivos y pasos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="datos.html"><a href="datos.html"><i class="fa fa-check"></i><b>2</b> Datos espaciales</a>
<ul>
<li class="chapter" data-level="2.1" data-path="datos-tipos.html"><a href="datos-tipos.html"><i class="fa fa-check"></i><b>2.1</b> Tipos de datos espaciales</a></li>
<li class="chapter" data-level="2.2" data-path="sf-intro.html"><a href="sf-intro.html"><i class="fa fa-check"></i><b>2.2</b> Introducción al paquete <strong>sf</strong></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sf-intro.html"><a href="sf-intro.html#crs"><i class="fa fa-check"></i><b>2.2.1</b> Sistemas de referencia de coordenadas</a></li>
<li class="chapter" data-level="2.2.2" data-path="sf-intro.html"><a href="sf-intro.html#tidyverse-sf"><i class="fa fa-check"></i><b>2.2.2</b> Integración con el ecosistema <strong>tidyverse</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="representación-de-datos-espaciales.html"><a href="representación-de-datos-espaciales.html"><i class="fa fa-check"></i><b>2.3</b> Representación de datos espaciales</a></li>
<li class="chapter" data-level="2.4" data-path="operaciones-datos.html"><a href="operaciones-datos.html"><i class="fa fa-check"></i><b>2.4</b> Operaciones con datos espaciales</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="operaciones-datos.html"><a href="operaciones-datos.html#importación-y-exportación-de-datos-espaciales"><i class="fa fa-check"></i><b>2.4.1</b> Importación y exportación de datos espaciales</a></li>
<li class="chapter" data-level="2.4.2" data-path="operaciones-datos.html"><a href="operaciones-datos.html#operaciones-con-geometrías"><i class="fa fa-check"></i><b>2.4.2</b> Operaciones con geometrías</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sp-eda.html"><a href="sp-eda.html"><i class="fa fa-check"></i><b>2.5</b> Análisis exploratorio de datos espaciales</a></li>
<li class="chapter" data-level="2.6" data-path="el-paquete-gstat.html"><a href="el-paquete-gstat.html"><i class="fa fa-check"></i><b>2.6</b> El paquete <strong>gstat</strong></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modelado.html"><a href="modelado.html"><i class="fa fa-check"></i><b>3</b> Modelado de procesos geoestadísticos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="vario-muestrales.html"><a href="vario-muestrales.html"><i class="fa fa-check"></i><b>3.1</b> Estimadores muestrales del semivariograma</a></li>
<li class="chapter" data-level="3.2" data-path="modelos-variog.html"><a href="modelos-variog.html"><i class="fa fa-check"></i><b>3.2</b> Modelos de semivariogramas</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="modelos-variog.html"><a href="modelos-variog.html#modelos-parametricos"><i class="fa fa-check"></i><b>3.2.1</b> Modelos paramétricos isotrópicos</a></li>
<li class="chapter" data-level="3.2.2" data-path="modelos-variog.html"><a href="modelos-variog.html#anisotropia"><i class="fa fa-check"></i><b>3.2.2</b> Modelado de anisotropía</a></li>
<li class="chapter" data-level="3.2.3" data-path="modelos-variog.html"><a href="modelos-variog.html#vario-lin-reg"><i class="fa fa-check"></i><b>3.2.3</b> El modelo lineal de regionalización</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ajuste-variog.html"><a href="ajuste-variog.html"><i class="fa fa-check"></i><b>3.3</b> Ajuste de un modelo válido</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="ajuste-variog.html"><a href="ajuste-variog.html#ls-fit"><i class="fa fa-check"></i><b>3.3.1</b> Estimación por mínimos cuadrados</a></li>
<li class="chapter" data-level="3.3.2" data-path="ajuste-variog.html"><a href="ajuste-variog.html#ml-fit"><i class="fa fa-check"></i><b>3.3.2</b> Estimación por máxima verosimilitud</a></li>
<li class="chapter" data-level="3.3.3" data-path="ajuste-variog.html"><a href="ajuste-variog.html#comentarios-sobre-los-distintos-métodos"><i class="fa fa-check"></i><b>3.3.3</b> Comentarios sobre los distintos métodos</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="modelado-conjunto-de-la-tendencia-y-del-variograma.html"><a href="modelado-conjunto-de-la-tendencia-y-del-variograma.html"><i class="fa fa-check"></i><b>3.4</b> Modelado conjunto de la tendencia y del variograma</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="kriging.html"><a href="kriging.html"><i class="fa fa-check"></i><b>4</b> Predicción Kriging</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>4.1</b> Introducción</a></li>
<li class="chapter" data-level="4.2" data-path="ksimple.html"><a href="ksimple.html"><i class="fa fa-check"></i><b>4.2</b> Kriging con media conocida: kriging simple</a></li>
<li class="chapter" data-level="4.3" data-path="kuniversal.html"><a href="kuniversal.html"><i class="fa fa-check"></i><b>4.3</b> Kriging con media desconocida: kriging universal y kriging residual</a></li>
<li class="chapter" data-level="4.4" data-path="consideraciones-kriging.html"><a href="consideraciones-kriging.html"><i class="fa fa-check"></i><b>4.4</b> Consideraciones acerca de los métodos kriging</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivar.html"><a href="multivar.html"><i class="fa fa-check"></i><b>5</b> Procesos espaciales multivariantes</a></li>
<li class="chapter" data-level="6" data-path="esp-temp.html"><a href="esp-temp.html"><i class="fa fa-check"></i><b>6</b> Procesos espaciales espacio-temporales</a></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="intro-sp.html"><a href="intro-sp.html"><i class="fa fa-check"></i><b>A</b> Introducción al paquete <strong>sp</strong></a>
<ul>
<li class="chapter" data-level="A.1" data-path="tipos-de-objetos.html"><a href="tipos-de-objetos.html"><i class="fa fa-check"></i><b>A.1</b> Tipos de objetos</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="tipos-de-objetos.html"><a href="tipos-de-objetos.html#spatialpoints-y-spatialpointsdataframe"><i class="fa fa-check"></i><b>A.1.1</b> SpatialPoints y SpatialPointsDataFrame</a></li>
<li class="chapter" data-level="A.1.2" data-path="tipos-de-objetos.html"><a href="tipos-de-objetos.html#spatiallines-y-spatialpolygons"><i class="fa fa-check"></i><b>A.1.2</b> SpatialLines y SpatialPolygons</a></li>
<li class="chapter" data-level="A.1.3" data-path="tipos-de-objetos.html"><a href="tipos-de-objetos.html#spatialgrid-y-spatialpixels"><i class="fa fa-check"></i><b>A.1.3</b> SpatialGrid y SpatialPixels</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="métodos-y-procedimientos-clases-sp.html"><a href="métodos-y-procedimientos-clases-sp.html"><i class="fa fa-check"></i><b>A.2</b> Métodos y procedimientos clases sp</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="métodos-y-procedimientos-clases-sp.html"><a href="métodos-y-procedimientos-clases-sp.html#importarexportartransformar"><i class="fa fa-check"></i><b>A.2.1</b> Importar/exportar/transformar</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="representaciones-gráficas.html"><a href="representaciones-gráficas.html"><i class="fa fa-check"></i><b>A.3</b> Representaciones gráficas</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="representaciones-gráficas.html"><a href="representaciones-gráficas.html#gráficos-estándar"><i class="fa fa-check"></i><b>A.3.1</b> Gráficos estándar</a></li>
<li class="chapter" data-level="A.3.2" data-path="representaciones-gráficas.html"><a href="representaciones-gráficas.html#gráficos-lattice-spplot"><i class="fa fa-check"></i><b>A.3.2</b> Gráficos lattice: spplot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="intro-geoR.html"><a href="intro-geoR.html"><i class="fa fa-check"></i><b>B</b> Introducción al paquete <strong>geoR</strong></a>
<ul>
<li class="chapter" data-level="B.1" data-path="inicio-de-una-sesión-y-de-carga-de-datos.html"><a href="inicio-de-una-sesión-y-de-carga-de-datos.html"><i class="fa fa-check"></i><b>B.1</b> Inicio de una sesión y de carga de datos</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="inicio-de-una-sesión-y-de-carga-de-datos.html"><a href="inicio-de-una-sesión-y-de-carga-de-datos.html#archivos-de-datos"><i class="fa fa-check"></i><b>B.1.1</b> Archivos de datos</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="análisis-descriptivo-de-datos-geoestadísticos.html"><a href="análisis-descriptivo-de-datos-geoestadísticos.html"><i class="fa fa-check"></i><b>B.2</b> Análisis descriptivo de datos geoestadísticos</a></li>
<li class="chapter" data-level="B.3" data-path="modelado-de-la-dependencia.html"><a href="modelado-de-la-dependencia.html"><i class="fa fa-check"></i><b>B.3</b> Modelado de la dependencia</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="modelado-de-la-dependencia.html"><a href="modelado-de-la-dependencia.html#variogramas-empíricos"><i class="fa fa-check"></i><b>B.3.1</b> Variogramas empíricos</a></li>
<li class="chapter" data-level="B.3.2" data-path="modelado-de-la-dependencia.html"><a href="modelado-de-la-dependencia.html#ajuste-de-un-modelo-de-variograma"><i class="fa fa-check"></i><b>B.3.2</b> Ajuste de un modelo de variograma</a></li>
<li class="chapter" data-level="B.3.3" data-path="modelado-de-la-dependencia.html"><a href="modelado-de-la-dependencia.html#inferencia-sobre-el-variograma"><i class="fa fa-check"></i><b>B.3.3</b> Inferencia sobre el variograma</a></li>
<li class="chapter" data-level="B.3.4" data-path="modelado-de-la-dependencia.html"><a href="modelado-de-la-dependencia.html#estimación-del-variograma-en-procesos-no-estacionarios"><i class="fa fa-check"></i><b>B.3.4</b> Estimación del variograma en procesos no estacionarios</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="predicción-espacial-kriging.html"><a href="predicción-espacial-kriging.html"><i class="fa fa-check"></i><b>B.4</b> Predicción espacial (kriging)</a>
<ul>
<li class="chapter" data-level="B.4.1" data-path="predicción-espacial-kriging.html"><a href="predicción-espacial-kriging.html#validación-cruzada"><i class="fa fa-check"></i><b>B.4.1</b> Validación cruzada</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a>
<ul>
<li class="chapter" data-level="" data-path="bibliografía-completa.html"><a href="bibliografía-completa.html"><i class="fa fa-check"></i>Bibliografía completa</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Espacial con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelos-variog" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Modelos de semivariogramas</h2>
<p>Los variogramas deben ser condicionalmente semidefinidos negativos, una propiedad que los estimadores tradicionales normalmente no poseen.
Tradicionalmente esto se remedia ajustando un modelo paramétrico válido al estimador muestral (Sección <a href="ajuste-variog.html#ajuste-variog">3.3</a>).
En la Sección <a href="modelos-variog.html#modelos-parametricos">3.2.1</a> se presentan algunos de los modelos isotrópicos tradicionalmente utilizados en geoestadística.
Estos modelos son empleados también en ciertos casos como estructuras básicas a partir de las cuales se construyen modelos más complejos, como modelos anisotrópicos (Sección <a href="modelos-variog.html#anisotropia">3.2.2</a>) o los denominados modelos lineales de regionalización (Sección <a href="modelos-variog.html#vario-lin-reg">3.2.3</a>).</p>
<div id="modelos-parametricos" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Modelos paramétricos isotrópicos</h3>
<p>A continuación se presentan algunos de los modelos isotrópicos de semivariograma más utilizados en geoestadística (una revisión más completa se tiene por ejemplo en Chilès y Delfiner, 1999, sección 2.5.1).
En la notación utilizada en las parametrizaciones <span class="math inline">\(c_{0} \geq 0\)</span> representa el efecto nugget, <span class="math inline">\(c_1 \geq 0\)</span> el umbral parcial (en el caso de variogramas acotados, con <span class="math inline">\(\sigma^2= c_0 + c_1\)</span>) y <span class="math inline">\(a&gt;0\)</span> el rango (si existe) o el parámetro de escala.
En el caso de semivariogramas acotados que alcanzan el umbral asintóticamente (rango infinito), el parámetro <span class="math inline">\(a\)</span> representa el rango práctico, definido como la distancia en la que el valor del semivariograma es el 95% del umbral parcial.
En la Figura <a href="modelos-variog.html#fig:show-vgms">3.1</a> se tienen algunos ejemplos de las formas de algunos de
estos semivariogramas.</p>
<ul>
<li><p>Modelo esférico:
<span class="math display">\[\gamma(\mathbf{h}\left| \boldsymbol{\theta}\right. ) = \left\{ 
\begin{array}{ll}
0 &amp; \text{si} \left\| \mathbf{h}\right\| =0 \\
c_{0} +c_1 \left\{ \dfrac{3}{2} \dfrac{\left\| \mathbf{h}\right\| }{a}
-\dfrac{1}{2} \left( \dfrac{\left\| \mathbf{h}\right\| }{a} \right)
3\right\}  &amp; \text{si} 0&lt;\left\| \mathbf{h}\right\| \leq a \\
c_{0} +c_1  &amp; \text{si} \left\| \mathbf{h}\right\| &gt;a
\end{array}
\right.\]</span>
válido en <span class="math inline">\(\mathbb{R}^{d}\)</span>, <span class="math inline">\(d=1,2,3\)</span>.</p></li>
<li><p>Modelo exponencial:
<span class="math display">\[\gamma(\mathbf{h}\left| \boldsymbol{\theta}\right. )\ =\ \left\{ 
\begin{array}{ll}
0 &amp; \text{si}\  \mathbf{h}=\mathbf{0} \\
c_{0} + c_1 \left( 1-\exp \left( -\dfrac{3\left\|
\mathbf{h}\right\| }{a} \right) \right)  &amp; \text{si}\  \mathbf{h}\neq
\mathbf{0}
\end{array}
\right.\]</span>
válido en <span class="math inline">\(\mathbb{R}^{d}\)</span>, <span class="math inline">\(\forall d \geq 1\)</span>.</p></li>
<li><p>Modelo racional cuadrático:
<span class="math display">\[\gamma(\mathbf{h}\left| \boldsymbol{\theta}\right. )\ =\ \left\{ 
\begin{array}{ll}
0 &amp; \text{si}\  \mathbf{h}=\mathbf{0} \\
c_{0} + c_1 \dfrac{\left\| \mathbf{h}\right\|^2
}{\frac{1}{19} a^2 +\left\| \mathbf{h}\right\|^2 }  &amp; \text{si}\ 
\mathbf{h}\neq \mathbf{0}
\end{array}
\right.\]</span>
válido en <span class="math inline">\(\mathbb{R}^{d}\)</span>, <span class="math inline">\(\forall d \geq 1\)</span>.</p></li>
<li><p>Modelo potencial:
<span class="math display">\[\gamma(\mathbf{h}\left| \boldsymbol{\theta}\right. )\ =\ \left\{ 
\begin{array}{ll}
0 &amp; \text{si}\  \mathbf{h}=\mathbf{0} \\
c_{0} + a\left\| \mathbf{h}\right\|^{\lambda }  &amp; \text{si}\ 
\mathbf{h}\neq \mathbf{0}
\end{array}
\right.\]</span>
con <span class="math inline">\(0\leq \lambda &lt;2\)</span> y válido en <span class="math inline">\(\mathbb{R}^{d}\)</span>, <span class="math inline">\(\forall d \geq 1\)</span>.
En el caso de <span class="math inline">\(\lambda =1\)</span> se obtiene el conocido modelo lineal.</p></li>
<li><p>Modelo exponencial-potencial:
<span class="math display">\[\gamma(\mathbf{h}\left| \boldsymbol{\theta}\right. )\ =\ \left\{ 
\begin{array}{ll}
0 &amp; \text{si}\  \mathbf{h}=\mathbf{0} \\
c_{0} + c_1 \left( 1-\exp \left( -3\left( \dfrac{\left\|
\mathbf{h}\right\| }{a} \right)^{\lambda } \right) \right)  &amp; \text{si}\ 
\mathbf{h}\neq \mathbf{0}
\end{array}
\right.\]</span>
con <span class="math inline">\(0\leq \lambda \leq 2\)</span> y válido en <span class="math inline">\(\mathbb{R}^{d}\)</span>, <span class="math inline">\(\forall d \geq 1\)</span>.
Cuando <span class="math inline">\(\lambda =2\)</span> es denominado modelo gausiano;
este modelo sin embargo no debería ser utilizado en la predicción
espacial debido a las inestabilidades numéricas que produce en los
algoritmos kriging (especialmente cuando el efecto nugget es grande; ver
p.e. Wackernagel, 1998, pp. 120-123).
El modelo exponencial se obtiene también como caso particular cuando <span class="math inline">\(\lambda =1\)</span>.</p></li>
<li><p>Modelo oscilatorio:
<span class="math display">\[\gamma(\mathbf{h}\left| \boldsymbol{\theta}\right. )\ =\ \left\{ 
\begin{array}{ll}
0 &amp; \text{si}\  \mathbf{h}=\mathbf{0} \\
c_{0} + c_1 \left( 1-\dfrac{a}{\left\| \mathbf{h}\right\| }
\text{sen} \left( \dfrac{\left\| \mathbf{h}\right\| }{a} \right) \right) 
&amp; \text{si}\  \mathbf{h}\neq \mathbf{0}
\end{array}
\right.\]</span>
válido en <span class="math inline">\(\mathbb{R}^{d}\)</span>, <span class="math inline">\(d=1,2,3\)</span>.
Este modelo con forma de onda (hay correlaciones negativas) alcanza su valor máximo ( <span class="math inline">\(c_{0} +1.218c_1\)</span>) cuando <span class="math inline">\(\left\| \mathbf{h}\right\| \simeq 4.5a\)</span>, siendo <span class="math inline">\(a\)</span> el parámetro de escala.</p></li>
<li><p>Modelo de Matérn (o K-Bessel):
<span class="math display">\[\gamma(\mathbf{h}\left| \boldsymbol{\theta}\right. )\ =\ \left\{ 
\begin{array}{ll}
0 &amp; \text{si}\  \mathbf{h}=\mathbf{0} \\
c_{0} + c_1 \left( 1-\dfrac{1}{2^{\nu -1} \gamma(\nu )} \left(
\dfrac{\left\| \mathbf{h}\right\| }{a} \right)^{\nu } K_{\nu } \left(
\dfrac{\left\| \mathbf{h}\right\| }{a} \right) \right)  &amp; \text{si}\ 
\mathbf{h}\neq \mathbf{0}
\end{array}
\right.\]</span>
siendo <span class="math inline">\(\nu \geq 0\)</span> (un parámetro de suavizado) y <span class="math inline">\(K_{\nu }\)</span> la función de Bessel modificada de tercera clase de orden <span class="math inline">\(\nu\)</span> (ver p.e. Abramowitz y Stegun, 1965, pp. 374-379).
Este modelo es válido en <span class="math inline">\(\mathbb{R}^{d}\)</span>, <span class="math inline">\(\forall d \geq 1\)</span>. El modelo exponencial se obtiene como caso particular cuando <span class="math inline">\(\nu =\frac{1}{2}\)</span> y en el límite <span class="math inline">\(\nu \rightarrow \infty\)</span> el modelo gausiano.</p></li>
</ul>
<p>En <code>gstat</code> se emplea la función <code>vgm()</code> (<em>Variogram Model</em>) para definir un modelo de variograma:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="modelos-variog.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vgm</span>(<span class="at">psill =</span> <span class="cn">NA</span>, model, <span class="at">range =</span> <span class="cn">NA</span>, nugget, add.to, anis, <span class="at">kappa =</span> <span class="fl">0.5</span>, ...)</span></code></pre></div>
<ul>
<li><code>psill</code>: umbral parcial (<span class="math inline">\(c_1\)</span>).</li>
<li><code>model</code>: cadena de texto que identifica el modelo (e.g. <code>"Exp"</code>, <code>"Sph"</code>, <code>"Gau"</code>, <code>"Mat"</code>…).</li>
<li><code>range</code>: rango o parámetro de escala (proporcional a <span class="math inline">\(a\)</span>).</li>
<li><code>nugget</code>: efecto nugget (<span class="math inline">\(c_0\)</span>).</li>
<li><code>kappa</code>: parametro de suavizado (<span class="math inline">\(\nu\)</span> en el modelo de Matérn).</li>
<li><code>add.to</code>: permite combinar modelos (Sección <a href="modelos-variog.html#vario-lin-reg">3.2.3</a>).</li>
<li><code>anis</code>: parámetros de anisotropía (Sección <a href="modelos-variog.html#anisotropia">3.2.2</a>).</li>
</ul>
<p>Lo habitual es definir un modelo para posteriormente estimar sus parámetros utilizando los empleados en la definición como valores iniciales. También se puede llamar a esta función con el modelo como primer y único argumento, indicando que los parámetros son desconocidos (o que tome los valores por defecto en el ajuste).
Si se ejecuta sin argumentos devuelve un listado de todos los modelos:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="modelos-variog.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vgm</span>()</span></code></pre></div>
<pre><code>##    short                                      long
## 1    Nug                              Nug (nugget)
## 2    Exp                         Exp (exponential)
## 3    Sph                           Sph (spherical)
## 4    Gau                            Gau (gaussian)
## 5    Exc        Exclass (Exponential class/stable)
## 6    Mat                              Mat (Matern)
## 7    Ste Mat (Matern, M. Stein&#39;s parameterization)
## 8    Cir                            Cir (circular)
## 9    Lin                              Lin (linear)
## 10   Bes                              Bes (bessel)
## 11   Pen                      Pen (pentaspherical)
## 12   Per                            Per (periodic)
## 13   Wav                                Wav (wave)
## 14   Hol                                Hol (hole)
## 15   Log                         Log (logarithmic)
## 16   Pow                               Pow (power)
## 17   Spl                              Spl (spline)
## 18   Leg                            Leg (Legendre)
## 19   Err                   Err (Measurement error)
## 20   Int                           Int (Intercept)</code></pre>
<p>La función <code>show.vgms()</code> genera gráficos con los distintos modelos (por defecto los 17 primeros):</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="modelos-variog.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show.vgms</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:show-vgms"></span>
<img src="03-modelado_files/figure-html/show-vgms-1.png" alt="Representaciones de los modelos paramétricos isotrópicos de semivariogramas implementados en el paquete `gstat`." width="70%" />
<p class="caption">
Figura 3.1: Representaciones de los modelos paramétricos isotrópicos de semivariogramas implementados en el paquete <code>gstat</code>.
</p>
</div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="modelos-variog.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show.vgms</span>(<span class="at">kappa.range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>), <span class="at">max =</span> <span class="dv">10</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:show-matern"></span>
<img src="03-modelado_files/figure-html/show-matern-1.png" alt="Modelo de Matérn con distintos valores del parámetro de suavizado." width="70%" />
<p class="caption">
Figura 3.2: Modelo de Matérn con distintos valores del parámetro de suavizado.
</p>
</div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="modelos-variog.html#cb82-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="at">psill =</span> <span class="dv">1</span>, <span class="at">model =</span> <span class="st">&quot;Exp&quot;</span>, <span class="at">range =</span> <span class="fl">0.5</span>, <span class="at">nugget =</span> <span class="dv">0</span>)</span>
<span id="cb82-2"><a href="modelos-variog.html#cb82-2" aria-hidden="true" tabindex="-1"></a>v1</span></code></pre></div>
<pre><code>##   model psill range
## 1   Nug     0   0.0
## 2   Exp     1   0.5</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="modelos-variog.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(v1, <span class="at">cutoff =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:vgm-exp"></span>
<img src="03-modelado_files/figure-html/vgm-exp-1.png" alt="Ejemplo de modelo exponencial." width="70%" />
<p class="caption">
Figura 3.3: Ejemplo de modelo exponencial.
</p>
</div>
</div>
<div id="anisotropia" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Modelado de anisotropía</h3>
<p>La hipótesis de isotropía simplifica notablemente el modelado de la dependencia espacial por lo que la mayoría de los modelos (básicos) de semivariogramas considerados en geoestadística son isotrópicos (Sección XX).
Sin embargo, en muchos casos no se puede asumir que la dependencia es igual en cualquier dirección (uno de los ejemplos más claros es el caso espacio-temporal, donde en principio no es razonable pensar que un salto espacial es equivalente a un salto temporal).
En esos casos se suelen considerar ligeras variaciones de la hipótesis de isotropía para modelar la dependencia espacial.
En esta sección se comentan brevemente las distintas aproximaciones tradicionalmente consideradas en geoestadística (para más detalles ver p.e. Chilès y Delfiner, 1999, sección 2.5.2, o Goovaerts, 1997, sección 4.2.2), otras aproximaciones adicionales se tratarán en el Capítulo 7 (caso espacio-temporal).</p>
<p>Cuando el variograma es función de la dirección además de la magnitud del salto, se dice que el variograma es anisotrópico (no isotrópico).
Los tipos de anisotropía habitualmente considerados son:</p>
<ul>
<li><em>Anisotropía geométrica</em>: cuando el umbral permanece constante mientras que el rango varía con la dirección.</li>
<li><em>Anisotropía zonal</em>: cuando el umbral del semivariograma varía con la dirección (también se denomina anisotropía estratificada).</li>
<li>Combinación de las anteriores.</li>
</ul>
<p>La anisotropía geométrica se puede corregir mediante una transformación lineal del vector de salto <span class="math inline">\(\mathbf{h}\)</span>:
<span class="math display">\[\gamma(\mathbf{h})=\gamma ^{0} \left( \left\| \mathbf{A}\mathbf{h}\right\| \right) ,\forall \mathbf{h}\in \mathbb{R}^{d},\]</span>
siendo <span class="math inline">\(\mathbf{A}\)</span> una matriz cuadrada <span class="math inline">\(d\times d\)</span> y <span class="math inline">\(\gamma ^{0} (\cdot)\)</span> un semivariograma isotrópico<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a>.
En este caso se dice que el variograma es <em>geométricamente anisotrópico</em>.
Por ejemplo, en el caso bidimensional, se suelen considerar una matriz de la forma:
<span class="math display">\[\mathbf{A}=\left( 
\begin{array}{cc}
1  &amp; 0 \\
0 &amp; a_2/a_1 
\end{array}
\right) \left( 
\begin{array}{cc}
\cos \theta  &amp; \sin\theta  \\
\text{-} \sin\theta  &amp; \cos \theta 
\end{array}
\right),\]</span>
que se corresponde con las direcciones principales de anisotropía <span class="math inline">\(\theta\)</span> y <span class="math inline">\(\theta + \frac{\pi }{\text{2}}\)</span> (normalmente se toma <span class="math inline">\(\theta\)</span> igual a la dirección de máximo rango).
Esto puede extenderse fácilmente para el caso tridimensional (ver p.e. Chilès y Delfiner, 1999, pp. 94-95).</p>
<p>En <code>gstat</code> se puede definir anisotropía mediante el argumento <code>anis</code> de la función <code>vgm()</code>.
En dos dimensiones es un vector con dos componentes <code>aniso = c(alpha, ratio)</code>, <code>alpha</code> es el ángulo para la dirección principal de variabilidad (medido en el sentido del reloj partiendo de la dirección norte) y <code>ratio</code> la relación entre el rango mínimo y máximo (<span class="math inline">\(0 \leq ratio \leq 1\)</span>).</p>
<p>Ejemplo:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="modelos-variog.html#cb85-1" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="dv">1</span>, <span class="st">&quot;Exp&quot;</span>, <span class="dv">5</span>, <span class="at">anis =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="fl">0.1</span>))</span>
<span id="cb85-2"><a href="modelos-variog.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(v)</span></code></pre></div>
<pre><code>## Classes &#39;variogramModel&#39; and &#39;data.frame&#39;:   1 obs. of  9 variables:
##  $ model: Factor w/ 20 levels &quot;Nug&quot;,&quot;Exp&quot;,&quot;Sph&quot;,..: 2
##  $ psill: num 1
##  $ range: num 5
##  $ kappa: num 0.5
##  $ ang1 : num 30
##  $ ang2 : num 0
##  $ ang3 : num 0
##  $ anis1: num 0.1
##  $ anis2: num 1</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="modelos-variog.html#cb87-1" aria-hidden="true" tabindex="-1"></a>plot_ellipse_2d <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">xc =</span> <span class="dv">0</span>, <span class="at">yc =</span> <span class="dv">0</span>, <span class="at">l1 =</span> <span class="dv">10</span>, <span class="at">l2 =</span> <span class="dv">1</span>, <span class="at">phi =</span> pi<span class="sc">/</span><span class="dv">3</span>, </span>
<span id="cb87-2"><a href="modelos-variog.html#cb87-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by =</span> <span class="fl">0.01</span>, <span class="at">asp =</span> <span class="dv">1</span>, ...) {</span>
<span id="cb87-3"><a href="modelos-variog.html#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># xc, yc: centro</span></span>
<span id="cb87-4"><a href="modelos-variog.html#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># l1, l2: longitud ejes</span></span>
<span id="cb87-5"><a href="modelos-variog.html#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># phi: angulo del eje 1 respecto al eje x</span></span>
<span id="cb87-6"><a href="modelos-variog.html#cb87-6" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi, by)</span>
<span id="cb87-7"><a href="modelos-variog.html#cb87-7" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> xc <span class="sc">+</span> l1<span class="sc">*</span><span class="fu">cos</span>(t)<span class="sc">*</span><span class="fu">cos</span>(phi) <span class="sc">-</span> l2<span class="sc">*</span><span class="fu">sin</span>(t)<span class="sc">*</span><span class="fu">sin</span>(phi)</span>
<span id="cb87-8"><a href="modelos-variog.html#cb87-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> yc <span class="sc">+</span> l1<span class="sc">*</span><span class="fu">cos</span>(t)<span class="sc">*</span><span class="fu">sin</span>(phi) <span class="sc">+</span> l2<span class="sc">*</span><span class="fu">sin</span>(t)<span class="sc">*</span><span class="fu">cos</span>(phi)</span>
<span id="cb87-9"><a href="modelos-variog.html#cb87-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">asp =</span> asp, ...)</span>
<span id="cb87-10"><a href="modelos-variog.html#cb87-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-11"><a href="modelos-variog.html#cb87-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-12"><a href="modelos-variog.html#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(v, <span class="fu">plot_ellipse_2d</span>(<span class="at">l1 =</span> range, <span class="at">l2 =</span> range<span class="sc">*</span>anis1, </span>
<span id="cb87-13"><a href="modelos-variog.html#cb87-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">phi =</span> (<span class="dv">90</span> <span class="sc">-</span> ang1)<span class="sc">*</span>pi<span class="sc">/</span><span class="dv">180</span>))</span>
<span id="cb87-14"><a href="modelos-variog.html#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb87-15"><a href="modelos-variog.html#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="03-modelado_files/figure-html/unnamed-chunk-9-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>En el caso de la anisotropía zonal se suele considerar una combinación de un semivariograma isotrópico más otros “zonales” que depende solamente de la distancia en ciertas direcciones (o componentes del vector de salto).
Por ejemplo, en el caso bidimensional, si <span class="math inline">\(\phi\)</span> es la dirección de mayor varianza se suele considerar una combinación de la forma:
<span class="math display">\[\gamma(\mathbf{h})=\gamma_1 (\left\| \mathbf{h}\right\|)+\gamma_2(h_{\phi }),\]</span>
siendo <span class="math inline">\(\gamma_1 (\cdot)\)</span> y <span class="math inline">\(\gamma_2 (\cdot)\)</span> semivariogramas isotrópicos, y <span class="math inline">\(h_{\phi } =\cos (\phi)h_1 +\sin(\phi)h_2\)</span> el salto en la dirección <span class="math inline">\(\phi\)</span>, para <span class="math inline">\(\mathbf{h}=(h_1 ,h_2)\in \mathbb{R} ^{2}\)</span>.
Es importante destacar que este tipo de anisotropías pueden causar la aparición de problemas al realizar predicción espacial (ver p.e. Myers y Journel, 1990; y Rouhani y Myers, 1990), como por ejemplo dar lugar a sistemas kriging no válidos con ciertas configuraciones de los datos.
Hay que tener un especial cuidado cuando el covariograma es expresado como suma de covariogramas unidimensionales, en cuyo caso el resultado puede ser únicamente condicionalmente semidefinido positivo sobre un dominio multidimensional.</p>
<p>Este tipo de modelos son casos particulares del modelo lineal de regionalización descrito en la siguiente sección.</p>
<p>Una variante de la anisotropía zonal es el caso de covariogramas separables (también denominados factorizables) en componentes del vector de salto.
Por ejemplo, un covariograma completamente separable en <span class="math inline">\(\mathbb{R}^2\)</span> es de la forma <span class="math inline">\(C(h_1, h_2)= C_1(h_1)C_2(h_2)\)</span>, siendo <span class="math inline">\(C_1(\cdot)\)</span> y <span class="math inline">\(C_2(\cdot)\)</span> covariogramas en <span class="math inline">\(\mathbb{R}^{1}\)</span>.
En este caso se puede pensar que el proceso espacial se obtiene como producto de procesos unidimensionales independientes definidos sobre cada uno de los ejes de coordenadas.
Este tipo de modelos se utilizan habitualmente en geoestadística espacio-temporal (aunque no permiten modelar interacciones).</p>
</div>
<div id="vario-lin-reg" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> El modelo lineal de regionalización</h3>
<p>En <code>gstat</code> se pueden definir modelos de este tipo empleando el parámetro <code>add.to</code> de la función <code>vgm()</code>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="modelos-variog.html#cb88-1" aria-hidden="true" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="at">psill =</span> <span class="dv">1</span>, <span class="at">model =</span> <span class="st">&quot;Gau&quot;</span>, <span class="at">range =</span> <span class="fl">0.5</span>)</span>
<span id="cb88-2"><a href="modelos-variog.html#cb88-2" aria-hidden="true" tabindex="-1"></a>v12 <span class="ot">&lt;-</span> <span class="fu">vgm</span>(<span class="at">psill =</span> <span class="dv">1</span>, <span class="at">model =</span> <span class="st">&quot;Gau&quot;</span>, <span class="at">range =</span> <span class="fl">0.5</span>, <span class="at">add.to =</span> v1)</span>
<span id="cb88-3"><a href="modelos-variog.html#cb88-3" aria-hidden="true" tabindex="-1"></a>v12</span></code></pre></div>
<pre><code>##   model psill range
## 1   Nug     0   0.0
## 2   Exp     1   0.5
## 3   Gau     1   0.5</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="modelos-variog.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">variogramLine</span>(v12, <span class="at">maxdist =</span> <span class="dv">3</span>), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.25</span>))</span>
<span id="cb90-2"><a href="modelos-variog.html#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">variogramLine</span>(v1, <span class="at">maxdist =</span> <span class="dv">3</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb90-3"><a href="modelos-variog.html#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">variogramLine</span>(v2, <span class="at">maxdist =</span> <span class="dv">3</span>), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb90-4"><a href="modelos-variog.html#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Exponencial&quot;</span>, <span class="st">&quot;Gaussiano&quot;</span>, <span class="st">&quot;Anidado&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>), </span>
<span id="cb90-5"><a href="modelos-variog.html#cb90-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="at">cex =</span> <span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="03-modelado_files/figure-html/unnamed-chunk-10-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="11">
<li id="fn11"><p>Esta idea (que el espacio euclídeo no es apropiado para medir distancias entre posiciones espaciales pero una transformación lineal de él sí) ha sido también generalizada para el caso de deformaciones no lineales del espacio. Por ejemplo, Sampson y Guttorp (1992) consideraron transformaciones no lineales obtenidas mediante técnicas de escalamiento óptimo multidimensional.<a href="modelos-variog.html#fnref11" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="vario-muestrales.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ajuste-variog.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rubenfcasal/estadistica_espacial/edit/master/03-modelado.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["estadistica_espacial.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

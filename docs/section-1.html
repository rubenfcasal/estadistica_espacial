<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.4  | Estadística Espacial con R</title>
  <meta name="description" content="Apuntes de Estadística Espacial (para las asignaturas: ‘Análisis estadístico de datos con dependencia’ del Grado en Ciencia e Ingeniería de Datos y ‘Aprendizaje estadístico’ del Máster InterUniversitario en Técnicas Estadísticas)." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="3.4  | Estadística Espacial con R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Apuntes de Estadística Espacial (para las asignaturas: ‘Análisis estadístico de datos con dependencia’ del Grado en Ciencia e Ingeniería de Datos y ‘Aprendizaje estadístico’ del Máster InterUniversitario en Técnicas Estadísticas)." />
  <meta name="github-repo" content="rubenfcasal/estadistica_espacial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.4  | Estadística Espacial con R" />
  
  <meta name="twitter:description" content="Apuntes de Estadística Espacial (para las asignaturas: ‘Análisis estadístico de datos con dependencia’ del Grado en Ciencia e Ingeniería de Datos y ‘Aprendizaje estadístico’ del Máster InterUniversitario en Técnicas Estadísticas)." />
  

<meta name="author" content="Rubén Fernández Casal (MODES, CITIC, UDC; ruben.fcasal@udc.es)" />
<meta name="author" content="Tomás Cotos Yáñez (SIDOR, UVIGO; cotos@uvigo.es)" />


<meta name="date" content="2021-11-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="section.html"/>
<link rel="next" href="representación-de-datos-espaciales.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.19/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Aprendizaje Estadístico</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> biblio-style: “apalike”</a></li>
<li class="chapter" data-level="2" data-path="intro-estesp.html"><a href="intro-estesp.html"><i class="fa fa-check"></i><b>2</b> Introducción: Procesos espaciales y Geoestadística</a>
<ul>
<li class="chapter" data-level="2.1" data-path="proc-esp.html"><a href="proc-esp.html"><i class="fa fa-check"></i><b>2.1</b> Procesos espaciales</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="proc-esp.html"><a href="proc-esp.html#paquetes-r"><i class="fa fa-check"></i><b>2.1.1</b> Paquetes de R</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="geoestadistica.html"><a href="geoestadistica.html"><i class="fa fa-check"></i><b>2.2</b> Geoestadística</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="geoestadistica.html"><a href="geoestadistica.html#modelos-clasicos-espaciales"><i class="fa fa-check"></i><b>2.2.1</b> Modelos clásicos y modelos espaciales</a></li>
<li class="chapter" data-level="2.2.2" data-path="geoestadistica.html"><a href="geoestadistica.html#ventajas-de-la-aproximación-espacial-y-espacio-temporal"><i class="fa fa-check"></i><b>2.2.2</b> Ventajas de la aproximación espacial (y espacio-temporal)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="procesos-estacionarios.html"><a href="procesos-estacionarios.html"><i class="fa fa-check"></i><b>2.3</b> Procesos espaciales estacionarios</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="procesos-estacionarios.html"><a href="procesos-estacionarios.html#propiedades-elementales"><i class="fa fa-check"></i><b>2.3.1</b> Propiedades elementales del covariograma y del variograma</a></li>
<li class="chapter" data-level="2.3.2" data-path="procesos-estacionarios.html"><a href="procesos-estacionarios.html#procesos-agregados"><i class="fa fa-check"></i><b>2.3.2</b> Procesos agregados</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="objetivos-esquema.html"><a href="objetivos-esquema.html"><i class="fa fa-check"></i><b>2.4</b> Objetivos y pasos</a></li>
<li class="chapter" data-level="2.5" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i><b>2.5</b> Referencias</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datos.html"><a href="datos.html"><i class="fa fa-check"></i><b>3</b> Datos espaciales</a>
<ul>
<li class="chapter" data-level="3.1" data-path="datos-tipos.html"><a href="datos-tipos.html"><i class="fa fa-check"></i><b>3.1</b> Tipos de datos espaciales</a></li>
<li class="chapter" data-level="3.2" data-path="sf-intro.html"><a href="sf-intro.html"><i class="fa fa-check"></i><b>3.2</b> Introducción al paquete <strong>sf</strong></a></li>
<li class="chapter" data-level="3.3" data-path="section.html"><a href="section.html"><i class="fa fa-check"></i><b>3.3</b> <!-- \@ref(exr:sfc) --></a></li>
<li class="chapter" data-level="3.4" data-path="section-1.html"><a href="section-1.html"><i class="fa fa-check"></i><b>3.4</b> <!-- \@ref(exr:aquifer1) --></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="section-1.html"><a href="section-1.html#crs"><i class="fa fa-check"></i><b>3.4.1</b> Sistemas de referencia de coordenadas</a></li>
<li class="chapter" data-level="3.4.2" data-path="section-1.html"><a href="section-1.html#tidyverse-sf"><i class="fa fa-check"></i><b>3.4.2</b> Integración con el ecosistema <strong>tidyverse</strong></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="representación-de-datos-espaciales.html"><a href="representación-de-datos-espaciales.html"><i class="fa fa-check"></i><b>3.5</b> Representación de datos espaciales</a></li>
<li class="chapter" data-level="3.6" data-path="operaciones-datos.html"><a href="operaciones-datos.html"><i class="fa fa-check"></i><b>3.6</b> Operaciones con datos espaciales</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="operaciones-datos.html"><a href="operaciones-datos.html#importación-y-exportación-de-datos-espaciales"><i class="fa fa-check"></i><b>3.6.1</b> Importación y exportación de datos espaciales</a></li>
<li class="chapter" data-level="3.6.2" data-path="operaciones-datos.html"><a href="operaciones-datos.html#operaciones-con-geometrías"><i class="fa fa-check"></i><b>3.6.2</b> Operaciones con geometrías</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="section-2.html"><a href="section-2.html"><i class="fa fa-check"></i><b>3.7</b> <!-- \@ref(exr:aquifer2) --></a></li>
<li class="chapter" data-level="3.8" data-path="sp-eda.html"><a href="sp-eda.html"><i class="fa fa-check"></i><b>3.8</b> Análisis exploratorio de datos espaciales</a></li>
<li class="chapter" data-level="3.9" data-path="section-3.html"><a href="section-3.html"><i class="fa fa-check"></i><b>3.9</b> <!-- \@ref(exr:descriptiva) --></a></li>
<li class="chapter" data-level="3.10" data-path="el-paquete-gstat.html"><a href="el-paquete-gstat.html"><i class="fa fa-check"></i><b>3.10</b> El paquete <strong>gstat</strong></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelado.html"><a href="modelado.html"><i class="fa fa-check"></i><b>4</b> Modelado de procesos geoestadísticos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="vario-muestrales.html"><a href="vario-muestrales.html"><i class="fa fa-check"></i><b>4.1</b> Estimadores muestrales del semivariograma</a></li>
<li class="chapter" data-level="4.2" data-path="modelos-variog.html"><a href="modelos-variog.html"><i class="fa fa-check"></i><b>4.2</b> Modelos de semivariogramas</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="modelos-variog.html"><a href="modelos-variog.html#modelos-parametricos"><i class="fa fa-check"></i><b>4.2.1</b> Modelos paramétricos isotrópicos</a></li>
<li class="chapter" data-level="4.2.2" data-path="modelos-variog.html"><a href="modelos-variog.html#anisotropia"><i class="fa fa-check"></i><b>4.2.2</b> Modelado de anisotropía</a></li>
<li class="chapter" data-level="4.2.3" data-path="modelos-variog.html"><a href="modelos-variog.html#vario-lin-reg"><i class="fa fa-check"></i><b>4.2.3</b> El modelo lineal de regionalización</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ajuste-variog.html"><a href="ajuste-variog.html"><i class="fa fa-check"></i><b>4.3</b> Ajuste de un modelo válido</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ajuste-variog.html"><a href="ajuste-variog.html#ls-fit"><i class="fa fa-check"></i><b>4.3.1</b> Estimación por mínimos cuadrados</a></li>
<li class="chapter" data-level="4.3.2" data-path="ajuste-variog.html"><a href="ajuste-variog.html#ml-fit"><i class="fa fa-check"></i><b>4.3.2</b> Estimación por máxima verosimilitud</a></li>
<li class="chapter" data-level="4.3.3" data-path="ajuste-variog.html"><a href="ajuste-variog.html#comentarios-sobre-los-distintos-métodos"><i class="fa fa-check"></i><b>4.3.3</b> Comentarios sobre los distintos métodos</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="modelado-conjunto-de-la-tendencia-y-del-variograma.html"><a href="modelado-conjunto-de-la-tendencia-y-del-variograma.html"><i class="fa fa-check"></i><b>4.4</b> Modelado conjunto de la tendencia y del variograma</a></li>
<li class="chapter" data-level="4.5" data-path="referencias-1.html"><a href="referencias-1.html"><i class="fa fa-check"></i><b>4.5</b> Referencias</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="kriging.html"><a href="kriging.html"><i class="fa fa-check"></i><b>5</b> Predicción Kriging</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>5.1</b> Introducción</a></li>
<li class="chapter" data-level="5.2" data-path="ksimple.html"><a href="ksimple.html"><i class="fa fa-check"></i><b>5.2</b> Kriging con media conocida: kriging simple</a></li>
<li class="chapter" data-level="5.3" data-path="kuniversal.html"><a href="kuniversal.html"><i class="fa fa-check"></i><b>5.3</b> Kriging con media desconocida: kriging universal y kriging residual</a></li>
<li class="chapter" data-level="5.4" data-path="consideraciones-kriging.html"><a href="consideraciones-kriging.html"><i class="fa fa-check"></i><b>5.4</b> Consideraciones acerca de los métodos kriging</a></li>
<li class="chapter" data-level="5.5" data-path="referencias-2.html"><a href="referencias-2.html"><i class="fa fa-check"></i><b>5.5</b> Referencias</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multivar.html"><a href="multivar.html"><i class="fa fa-check"></i><b>6</b> Procesos espaciales multivariantes</a>
<ul>
<li class="chapter" data-level="6.1" data-path="referencias-3.html"><a href="referencias-3.html"><i class="fa fa-check"></i><b>6.1</b> Referencias</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="esp-temp.html"><a href="esp-temp.html"><i class="fa fa-check"></i><b>7</b> Procesos espaciales espacio-temporales</a>
<ul>
<li class="chapter" data-level="7.1" data-path="referencias-4.html"><a href="referencias-4.html"><i class="fa fa-check"></i><b>7.1</b> Referencias</a></li>
</ul></li>
<li class="chapter" data-level="" data-path=""><a href="#appendix-apendices"><i class="fa fa-check"></i>(APPENDIX) Apendices</a>
<ul>
<li class="chapter" data-level="7.2" data-path="tipos-de-objetos.html"><a href="tipos-de-objetos.html"><i class="fa fa-check"></i><b>7.2</b> Tipos de objetos</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="tipos-de-objetos.html"><a href="tipos-de-objetos.html#spatialpoints-y-spatialpointsdataframe"><i class="fa fa-check"></i><b>7.2.1</b> SpatialPoints y SpatialPointsDataFrame</a></li>
<li class="chapter" data-level="7.2.2" data-path="tipos-de-objetos.html"><a href="tipos-de-objetos.html#spatiallines-y-spatialpolygons"><i class="fa fa-check"></i><b>7.2.2</b> SpatialLines y SpatialPolygons</a></li>
<li class="chapter" data-level="7.2.3" data-path="tipos-de-objetos.html"><a href="tipos-de-objetos.html#spatialgrid-y-spatialpixels"><i class="fa fa-check"></i><b>7.2.3</b> SpatialGrid y SpatialPixels</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="métodos-y-procedimientos-clases-sp.html"><a href="métodos-y-procedimientos-clases-sp.html"><i class="fa fa-check"></i><b>7.3</b> Métodos y procedimientos clases sp</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="métodos-y-procedimientos-clases-sp.html"><a href="métodos-y-procedimientos-clases-sp.html#importarexportartransformar"><i class="fa fa-check"></i><b>7.3.1</b> Importar/exportar/transformar</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="representaciones-gráficas.html"><a href="representaciones-gráficas.html"><i class="fa fa-check"></i><b>7.4</b> Representaciones gráficas</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="representaciones-gráficas.html"><a href="representaciones-gráficas.html#gráficos-estándar"><i class="fa fa-check"></i><b>7.4.1</b> Gráficos estándar</a></li>
<li class="chapter" data-level="7.4.2" data-path="representaciones-gráficas.html"><a href="representaciones-gráficas.html#gráficos-lattice-spplot"><i class="fa fa-check"></i><b>7.4.2</b> Gráficos lattice: spplot</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="referencias-5.html"><a href="referencias-5.html"><i class="fa fa-check"></i><b>7.5</b> Referencias</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="intro-geoR.html"><a href="intro-geoR.html"><i class="fa fa-check"></i><b>8</b> Introducción al paquete <strong>geoR</strong></a>
<ul>
<li class="chapter" data-level="8.1" data-path="inicio-de-una-sesión-y-de-carga-de-datos.html"><a href="inicio-de-una-sesión-y-de-carga-de-datos.html"><i class="fa fa-check"></i><b>8.1</b> Inicio de una sesión y de carga de datos</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="inicio-de-una-sesión-y-de-carga-de-datos.html"><a href="inicio-de-una-sesión-y-de-carga-de-datos.html#archivos-de-datos"><i class="fa fa-check"></i><b>8.1.1</b> Archivos de datos</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="análisis-descriptivo-de-datos-geoestadísticos.html"><a href="análisis-descriptivo-de-datos-geoestadísticos.html"><i class="fa fa-check"></i><b>8.2</b> Análisis descriptivo de datos geoestadísticos</a></li>
<li class="chapter" data-level="8.3" data-path="modelado-de-la-dependencia.html"><a href="modelado-de-la-dependencia.html"><i class="fa fa-check"></i><b>8.3</b> Modelado de la dependencia</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="modelado-de-la-dependencia.html"><a href="modelado-de-la-dependencia.html#variogramas-empíricos"><i class="fa fa-check"></i><b>8.3.1</b> Variogramas empíricos</a></li>
<li class="chapter" data-level="8.3.2" data-path="modelado-de-la-dependencia.html"><a href="modelado-de-la-dependencia.html#ajuste-de-un-modelo-de-variograma"><i class="fa fa-check"></i><b>8.3.2</b> Ajuste de un modelo de variograma</a></li>
<li class="chapter" data-level="8.3.3" data-path="modelado-de-la-dependencia.html"><a href="modelado-de-la-dependencia.html#inferencia-sobre-el-variograma"><i class="fa fa-check"></i><b>8.3.3</b> Inferencia sobre el variograma</a></li>
<li class="chapter" data-level="8.3.4" data-path="modelado-de-la-dependencia.html"><a href="modelado-de-la-dependencia.html#estimación-del-variograma-en-procesos-no-estacionarios"><i class="fa fa-check"></i><b>8.3.4</b> Estimación del variograma en procesos no estacionarios</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="predicción-espacial-kriging.html"><a href="predicción-espacial-kriging.html"><i class="fa fa-check"></i><b>8.4</b> Predicción espacial (kriging)</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="predicción-espacial-kriging.html"><a href="predicción-espacial-kriging.html#validación-cruzada"><i class="fa fa-check"></i><b>8.4.1</b> Validación cruzada</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias-6.html"><a href="referencias-6.html"><i class="fa fa-check"></i>Referencias</a>
<ul>
<li class="chapter" data-level="" data-path="bibliografía-completa.html"><a href="bibliografía-completa.html"><i class="fa fa-check"></i>Bibliografía completa</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Espacial con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-1" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> <!-- \@ref(exr:aquifer1) --></h2>
<div id="crs" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Sistemas de referencia de coordenadas</h3>
<p>El sistema de referencia de coordenadas (CRS) especifica la correspondencia entre valores de las coordenadas y puntos concretos en la superficie de la Tierra (o del espacio), y resulta fundamental cuando se combinan datos espaciales.
En general se consideran dos tipos de CRS:</p>
<ul>
<li><p>Geodésico: las coordenadas en tres dimensiones (latitud, longitud y altura) se basan en un elipsoide de referencia (global o local) que sirve como aproximación del globo terrestre (se tiene en cuenta que no es una esfera perfecta e incluso que puede haber variaciones locales). Este elipsoide, junto con información adicional sobre como interpretar las coordenadas (incluyendo el orden y el origen), define el denominado <em>datum</em>. Normalmente se asume que las coordenadas son en la superficie terrestre y solo se consideran:</p>
<ul>
<li>latitud: ángulo entre el plano ecuatorial y la línea que une la posición con el centro de la Tierra. Varía desde -90 (polo sur) hasta 90 (polo norte). Un grado equivale aproximadamente a 110.6 km. Los paralelos son las líneas en la superficie terrestre correspondientes a la misma latitud (siendo el 0 el ecuador).</li>
<li>longitud: ángulo (paralelo al plano ecuatorial) entre un meridiano de referencia (arco máximo que une los polos pasando por una determinado punto, normalmente el observatorio de Greenwich) y la línea que une la posición con el centro de la Tierra. Varía desde -180 (oeste) hasta 180 (este). Un grado en el ecuador equivale a aproximadamente a 111.3 km. Los meridianos son las líneas en la superficie terrestre correspondientes a la misma longitud (siendo el 0 el meridiano de Greenwich y -180 o 180 el correspondiente antimeridiano).</li>
</ul>
<p>La rejilla correspondiente a un conjunto de paralelos y meridianos se denomina <em>gratícula</em> (ver <code>st_graticule()</code>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:latlon"></span>
<img src="images/Latitud_y_Longitud.svg" alt="Coordenadas geográficas en la superficie terrestre (Fuente Wikimedia Commons)." width="85%" />
<p class="caption">
Figura 3.2: Coordenadas geográficas en la superficie terrestre (Fuente Wikimedia Commons).
</p>
</div>
<!-- 
[Wikimedia Commons](https://commons.wikimedia.org/wiki/File:Latitud_y_Longitud_en_la_Tierra.svg) 
https://upload.wikimedia.org/wikipedia/commons/5/58/Latitud_y_Longitud_en_la_Tierra.svg
-->
<p>Uno de los CRS más empleados es el WGS84 (<em>World Geodetic System 1984</em>) en el que se basa el <em>Sistema de Posicionamiento Global</em> (GPS).</p></li>
<li><p>Proyectado (cartesiano): sistema (local) en dos dimensiones que facilita algún tipo de cálculo (normalmente distancias o áreas). Por ejemplo el UTM (<em>Universal Transverse Mercator</em>), que emplea coordenadas en metros respecto a una cuadrícula de referencia (se divide la tierra en 60 husos de longitud, numerados, y 20 bandas de latitud, etiquetadas con letras; por ejemplo Galicia se encuentra en la cuadricula 29T). Se define relacionando estas coordenadas cartesianas con coordenadas geodésicas con un determinado datum.</p></li>
</ul>
<p>En <code>sf</code> se emplea la librería <a href="http://proj.org/">PRØJ</a> para definir el CRS y convertir coordenadas en distintos sistemas<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>.
Para obtener o establecer el CRS se puede emplear la función <code>st_crs()</code>.
Se puede especificar mediante una cadena de texto que admita <a href="https://gdal.org/tutorials/osr_api_tut.html">GDAL</a> (por ejemplo <code>"WGS84"</code>, que se corresponde con el <em>World Geodetic System 1984</em>), que típicamente es de la forma ESTÁNDAR:CÓDIGO.
El estándar más empleado es el <a href="https://epsg.org">EPSG</a> (<em>European Petroleum Survey Group</em>), y es que que da por hecho el paquete <code>sf</code> cuando se especifica el CRS mediante un número.
También admite el estándar <a href="http://www.opengeospatial.org/standards/wkt-crs">OGC WKT</a> (<em>Open Geospatial Consortium well-known text</em>) que es el que emplea internamente, pero resulta complicado manejar en la práctica.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="section-1.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(<span class="st">&quot;WGS84&quot;</span>)</span></code></pre></div>
<pre><code>## Coordinate Reference System:
##   User input: WGS84 
##   wkt:
## GEOGCRS[&quot;WGS 84&quot;,
##     DATUM[&quot;World Geodetic System 1984&quot;,
##         ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
##             LENGTHUNIT[&quot;metre&quot;,1]]],
##     PRIMEM[&quot;Greenwich&quot;,0,
##         ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##     CS[ellipsoidal,2],
##         AXIS[&quot;geodetic latitude (Lat)&quot;,north,
##             ORDER[1],
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##         AXIS[&quot;geodetic longitude (Lon)&quot;,east,
##             ORDER[2],
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##     ID[&quot;EPSG&quot;,4326]]</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="section-1.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(<span class="fu">st_crs</span>(<span class="dv">4326</span>), <span class="fu">st_crs</span>(<span class="st">&quot;EPSG:4326&quot;</span>), <span class="fu">st_crs</span>(<span class="st">&quot;WGS84&quot;</span>))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="section-1.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(nc)</span></code></pre></div>
<pre><code>## Coordinate Reference System:
##   User input: NAD27 
##   wkt:
## GEOGCRS[&quot;NAD27&quot;,
##     DATUM[&quot;North American Datum 1927&quot;,
##         ELLIPSOID[&quot;Clarke 1866&quot;,6378206.4,294.978698213898,
##             LENGTHUNIT[&quot;metre&quot;,1]]],
##     PRIMEM[&quot;Greenwich&quot;,0,
##         ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##     CS[ellipsoidal,2],
##         AXIS[&quot;latitude&quot;,north,
##             ORDER[1],
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##         AXIS[&quot;longitude&quot;,east,
##             ORDER[2],
##             ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
##     ID[&quot;EPSG&quot;,4267]]</code></pre>
<p>En <a href="https://spatialreference.org">spatialreference.org</a> se puede obtener información detallada sobre una gran cantidad de proyecciones (y permite realizar búsquedas).
También puede ser de utilidad <a href="https://epsg.io">epsg.io</a> o este <a href="https://proj.org/operations/projections">listado</a> con detalles de los parámetros.</p>
<p>El CRS ideal dependerá del tipo de problema y de la zona cubierta por los datos (ver e.g Lovelace et al, 2021, <a href="https://geocompr.robinlovelace.net/reproj-geo-data.html#which-crs-to-use">Sección 6.3</a>, para más información).
En general en estadística espacial nos interesará trabajar con coordenadas proyectadas, de forma que tenga sentido emplear la distancia euclídea (algo que puede ser poco o nada razonable si se trabaja con coordenadas geodésicas en una zona muy amplia del globo o cerca de los polos).
En el caso de coordenadas sin proyectar (latitud/longitud) puede ser preferible trabajar con distancias ortodrómicas (longitud del arco del círculo máximo que une los puntos, <em>great circle distances</em>)<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>.
Es importante destacar que cambiar el CRS no reproyecta los datos, hay que emplear <code>st_transform()</code> para hacerlo, como se describe en la Sección <a href="operaciones-datos.html#operaciones-datos">3.6</a>.</p>
<p>Finalmente hay que insistir también en que el campo de aplicación de la estadística espacial no se restringe al análisis de datos geográficos (por ejemplo nos puede interesar analizar el desgaste en la pared de un crisol empleado en fundición) y en estos casos los CRS geográficos carecen de sentido.
De todos modos habrá que emplear un sistema de coordenadas que permita calcular algún tipo de salto o distancia entre puntos (aunque siempre se pueden considerar coordenadas espaciales tres dimensiones con la distancia euclídea).</p>
</div>
<div id="tidyverse-sf" class="section level3" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Integración con el ecosistema <strong>tidyverse</strong></h3>
<p>El paquete <code>sf</code> es compatible con <a href="http://tidyverse.org"><code>tidyverse</code></a> y proporciona métodos para interactuar con los paquetes <a href="https://dplyr.tidyverse.org"><code>dplyr</code></a>,
<a href="http://tidyr.tidyverse.org"><code>tidyr</code></a> y <a href="https://ggplot2.tidyverse.org"><code>ggplot2</code></a>.</p>
<p>Algunos de los métodos de interés para manipular datos espaciales con el paquete <a href="https://dplyr.tidyverse.org"><code>dplyr</code></a> son:</p>
<ul>
<li><code>filter()</code>, <code>select()</code>, <code>mutate()</code>, <code>summarise(..., do_union = TRUE, is_coverage = FALSE)</code>, <code>group_by()</code>, <code>ungroup()</code>, etc.</li>
<li><code>inner_join()</code>, <code>left_join()</code>, <code>right_join()</code>, <code>full_join()</code>, <code>semi_join()</code>, <code>anti_join()</code>, <code>st_join()</code>.</li>
<li><code>st_drop_geometry()</code>, <code>st_set_crs()</code>.</li>
</ul>
<p>Para detalles ver la <a href="https://r-spatial.github.io/sf/reference/tidyverse.html">referencia</a>.</p>
<!-- , `rowwise()`,  `transmute()`, `rename()`, `arrange()`, `slice()`,  `distinct()`, `gather()`, `spread()`, `sample_n()`, `sample_frac()`, `nest()`, `separate()`, `separate_rows()`, `unite()`, `unnest()`,  -->
<p>En el caso del paquete <a href="https://ggplot2.tidyverse.org"><code>ggplot2</code></a> se puede consultar la <a href="https://ggplot2.tidyverse.org/reference/ggsf.html">referencia</a> y el tutorial <em>Drawing beautiful maps programmatically with R, sf and ggplot2</em>:</p>
<ul>
<li><a href="https://r-spatial.org/r/2018/10/25/ggplot2-sf.html">Part 1: Basics (General concepts illustrated with the world Map)</a>.</li>
<li><a href="https://r-spatial.org/r/2018/10/25/ggplot2-sf-2.html">Part 2: Layers (Adding additional layers: an example with points and polygons)</a>.</li>
<li><a href="https://r-spatial.org/r/2018/10/25/ggplot2-sf-3.html">Part 3: Layouts (Positioning and layout for complex maps)</a>.</li>
</ul>
<p>Por ejemplo, se puede generar un gráfico similar al de la Figura <a href="#fig:mortalidad"><strong>??</strong></a> (porcentaje de incremento de las defunciones en el año 2020 respecto al 2019 en las CCAA españolas; datos provisionales <a href="https://www.ine.es/jaxi/Tabla.htm?tpx=21856&amp;L=0">INE</a>), con el siguiente código:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="section-1.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb33-2"><a href="section-1.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapSpain) </span>
<span id="cb33-3"><a href="section-1.html#cb33-3" aria-hidden="true" tabindex="-1"></a>mortalidad <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">&quot;datos/mortalidad.csv&quot;</span>)</span>
<span id="cb33-4"><a href="section-1.html#cb33-4" aria-hidden="true" tabindex="-1"></a>CCAA_sf <span class="ot">&lt;-</span> <span class="fu">esp_get_ccaa</span>() <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(mortalidad) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="section-1.html#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">incremento =</span> <span class="dv">100</span><span class="sc">*</span>(mort<span class="fl">.2020</span> <span class="sc">-</span> mort<span class="fl">.2019</span>)<span class="sc">/</span>mort<span class="fl">.2019</span>)</span>
<span id="cb33-6"><a href="section-1.html#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="section-1.html#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb33-8"><a href="section-1.html#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CCAA_sf) <span class="sc">+</span></span>
<span id="cb33-9"><a href="section-1.html#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> incremento), <span class="at">color =</span> <span class="st">&quot;grey70&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-10"><a href="section-1.html#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">hcl.colors</span>(<span class="dv">10</span>, <span class="st">&quot;Blues&quot;</span>, <span class="at">rev =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb33-11"><a href="section-1.html#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(incremento, <span class="dv">1</span>), <span class="st">&quot;%&quot;</span>)), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb33-12"><a href="section-1.html#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> <span class="fu">esp_get_can_box</span>(), <span class="at">color =</span> <span class="st">&quot;grey70&quot;</span>) <span class="sc">+</span> </span>
<span id="cb33-13"><a href="section-1.html#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dplyr-ggplot"></span>
<img src="02-datos_files/figure-html/dplyr-ggplot-1.png" alt="Ejemplo de gráfico generado empleando los paquetes `dplyr` y `ggplot2`." width="70%" />
<p class="caption">
Figura 3.3: Ejemplo de gráfico generado empleando los paquetes <code>dplyr</code> y <code>ggplot2</code>.
</p>
</div>
<p>Sin embargo, en estos apuntes se supone que no se está familiarizado con estas herramientas y se evitará su uso (aunque pueden resultar más cómodas después de su aprendizaje).
Para una introducción a <a href="https://dplyr.tidyverse.org"><code>dplyr</code></a>, ver por ejemplo la viñeta <a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/dplyr.html">Introduction to dplyr</a>,
el <a href="http://r4ds.had.co.nz/transform.html">Capítulo 5</a> del libro <a href="http://r4ds.had.co.nz">R for Data Science</a> o el <a href="https://gltaboada.github.io/tgdbook/dplyr.html">Capítulo 4</a> de los apuntes <a href="https://gltaboada.github.io/tgdbook">Prácticas de Tecnologías de Gestión y Manipulación de Datos</a>.</p>
<p>No obstante, en ciertas ocasiones emplearemos el operador <em>pipe</em> <code>%&gt;%</code> (tubería, redirección) por comodidad.
Este operador permite canalizar la salida de una función a la entrada de otra.
Por ejemplo <code>segundo(primero(datos))</code> se traduce en <code>datos %&gt;% primero %&gt;% segundo</code>
(facilitando la lectura de expresiones de izquierda a derecha).</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>El paquete <code>sf</code> admite las últimas versiones PROJ 5 y 6, incluyendo el formato WKT-2 de 2019, mientras que el paquete <code>sp</code> está diseñado para cadenas <em>PROJ.4 string</em> que se recomiendan abandonar (las últimas versiones permiten añadir una cadena WKT2 como <code>comment</code>).<a href="section-1.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Algo que ya hace de forma automática el paquete <code>gstat</code>.<a href="section-1.html#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="representación-de-datos-espaciales.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rubenfcasal/estadistica_espacial/edit/master/02-datos.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["estadistica_espacial.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
